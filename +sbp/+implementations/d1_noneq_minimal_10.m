function [D1,H,x,h] = d1_noneq_minimal_10(N,L)

% L: Domain length
% N: Number of grid points
if(nargin < 2)
    L = 1;
end

if(N<16)
    error('Operator requires at least 16 grid points');
end

% BP: Number of boundary points
% m:  Number of nonequidistant spacings
% order: Accuracy of interior stencil
BP = 8;
m = 3;
order = 10;

%%%% Non-equidistant grid points %%%%%
x0 =  0.0000000000000e+00;
x1 =  5.8556160757529e-01;
x2 =  1.7473267488572e+00;
x3 =  3.0000000000000e+00;
x4 =  4.0000000000000e+00;
x5 =  5.0000000000000e+00;
x6 =  6.0000000000000e+00;
x7 =  7.0000000000000e+00;
x8 =  8.0000000000000e+00;

xb = zeros(m+1,1);
for i = 0:m
    xb(i+1) = eval(['x' num2str(i)]);
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%% Compute h %%%%%%%%%%
h = L/(2*xb(end) + N-1-2*m);
%%%%%%%%%%%%%%%%%%%%%%%%%

%%%% Define grid %%%%%%%%
x = h*[xb; linspace(xb(end)+1,L/h-xb(end)-1,N-2*(m+1))'; L/h-flip(xb) ];
%%%%%%%%%%%%%%%%%%%%%%%%%

%%%% Norm matrix %%%%%%%%
P = zeros(BP,1);
%#ok<*NASGU>
P0 =  1.6717213975289e-01;
P1 =  9.3675739171278e-01;
P2 =  1.3035532379753e+00;
P3 =  1.1188461804303e+00;
P4 =  9.6664345922660e-01;
P5 =  1.0083235564392e+00;
P6 =  9.9858767377362e-01;
P7 =  1.0001163606893e+00;

for i = 0:BP-1
    P(i+1) = eval(['P' num2str(i)]);
end

H = ones(N,1);
H(1:BP) = P;
H(end-BP+1:end) = flip(P);
H = spdiags(h*H,0,N,N);
%%%%%%%%%%%%%%%%%%%%%%%%%

%%%% Q matrix %%%%%%%%%%%

% interior stencil
switch order
    case 2
        d = [-1/2,0,1/2];
    case 4
        d = [1/12,-2/3,0,2/3,-1/12];
    case 6
        d = [-1/60,3/20,-3/4,0,3/4,-3/20,1/60];
    case 8
        d = [1/280,-4/105,1/5,-4/5,0,4/5,-1/5,4/105,-1/280];
    case 10
        d = [-1/1260,5/504,-5/84,5/21,-5/6,0,5/6,-5/21,5/84,-5/504,1/1260];
    case 12
        d = [1/5544,-1/385,1/56,-5/63,15/56,-6/7,0,6/7,-15/56,5/63,-1/56,1/385,-1/5544];
end
d = repmat(d,N,1);
Q = spdiags(d,-order/2:order/2,N,N);

% Boundaries
Q0_0 = -5.0000000000000e-01;
Q0_1 =  6.7349296966214e-01;
Q0_2 = -2.5186401896559e-01;
Q0_3 =  8.3431385420901e-02;
Q0_4 =  2.5480326895984e-02;
Q0_5 = -4.5992420658252e-02;
Q0_6 =  1.7526412909003e-02;
Q0_7 = -2.0746552641799e-03;
Q0_8 =  0.0000000000000e+00;
Q0_9 =  0.0000000000000e+00;
Q0_10 =  0.0000000000000e+00;
Q0_11 =  0.0000000000000e+00;
Q0_12 =  0.0000000000000e+00;
Q1_0 = -6.7349296966214e-01;
Q1_1 =  0.0000000000000e+00;
Q1_2 =  9.1982892384044e-01;
Q1_3 = -2.7262271754043e-01;
Q1_4 = -5.0992113348238e-02;
Q1_5 =  1.1814647281129e-01;
Q1_6 = -4.6693123378079e-02;
Q1_7 =  5.8255272771571e-03;
Q1_8 =  0.0000000000000e+00;
Q1_9 =  0.0000000000000e+00;
Q1_10 =  0.0000000000000e+00;
Q1_11 =  0.0000000000000e+00;
Q1_12 =  0.0000000000000e+00;
Q2_0 =  2.5186401896559e-01;
Q2_1 = -9.1982892384044e-01;
Q2_2 =  0.0000000000000e+00;
Q2_3 =  7.8566746772741e-01;
Q2_4 = -2.4097806629929e-02;
Q2_5 = -1.5312168858669e-01;
Q2_6 =  6.9451518963875e-02;
Q2_7 = -9.9345865998262e-03;
Q2_8 =  0.0000000000000e+00;
Q2_9 =  0.0000000000000e+00;
Q2_10 =  0.0000000000000e+00;
Q2_11 =  0.0000000000000e+00;
Q2_12 =  0.0000000000000e+00;
Q3_0 = -8.3431385420901e-02;
Q3_1 =  2.7262271754043e-01;
Q3_2 = -7.8566746772741e-01;
Q3_3 =  0.0000000000000e+00;
Q3_4 =  6.2047871210535e-01;
Q3_5 =  1.4776775176509e-02;
Q3_6 = -4.6889652372990e-02;
Q3_7 =  7.3166499053672e-03;
Q3_8 =  7.9365079365079e-04;
Q3_9 =  0.0000000000000e+00;
Q3_10 =  0.0000000000000e+00;
Q3_11 =  0.0000000000000e+00;
Q3_12 =  0.0000000000000e+00;
Q4_0 = -2.5480326895984e-02;
Q4_1 =  5.0992113348238e-02;
Q4_2 =  2.4097806629929e-02;
Q4_3 = -6.2047871210535e-01;
Q4_4 =  0.0000000000000e+00;
Q4_5 =  6.9425006383507e-01;
Q4_6 = -1.5686345740485e-01;
Q4_7 =  4.2609496719925e-02;
Q4_8 = -9.9206349206349e-03;
Q4_9 =  7.9365079365079e-04;
Q4_10 =  0.0000000000000e+00;
Q4_11 =  0.0000000000000e+00;
Q4_12 =  0.0000000000000e+00;
Q5_0 =  4.5992420658252e-02;
Q5_1 = -1.1814647281129e-01;
Q5_2 =  1.5312168858669e-01;
Q5_3 = -1.4776775176509e-02;
Q5_4 = -6.9425006383507e-01;
Q5_5 =  0.0000000000000e+00;
Q5_6 =  8.0719535654891e-01;
Q5_7 = -2.2953297936781e-01;
Q5_8 =  5.9523809523809e-02;
Q5_9 = -9.9206349206349e-03;
Q5_10 =  7.9365079365079e-04;
Q5_11 =  0.0000000000000e+00;
Q5_12 =  0.0000000000000e+00;
Q6_0 = -1.7526412909003e-02;
Q6_1 =  4.6693123378079e-02;
Q6_2 = -6.9451518963875e-02;
Q6_3 =  4.6889652372990e-02;
Q6_4 =  1.5686345740485e-01;
Q6_5 = -8.0719535654891e-01;
Q6_6 =  0.0000000000000e+00;
Q6_7 =  8.3142546796428e-01;
Q6_8 = -2.3809523809524e-01;
Q6_9 =  5.9523809523809e-02;
Q6_10 = -9.9206349206349e-03;
Q6_11 =  7.9365079365079e-04;
Q6_12 =  0.0000000000000e+00;
Q7_0 =  2.0746552641799e-03;
Q7_1 = -5.8255272771571e-03;
Q7_2 =  9.9345865998262e-03;
Q7_3 = -7.3166499053672e-03;
Q7_4 = -4.2609496719925e-02;
Q7_5 =  2.2953297936781e-01;
Q7_6 = -8.3142546796428e-01;
Q7_7 =  0.0000000000000e+00;
Q7_8 =  8.3333333333333e-01;
Q7_9 = -2.3809523809524e-01;
Q7_10 =  5.9523809523809e-02;
Q7_11 = -9.9206349206349e-03;
Q7_12 =  7.9365079365079e-04;
for i = 1:BP
    for j = 1:BP
        Q(i,j) = eval(['Q' num2str(i-1) '_' num2str(j-1)]);
        Q(N+1-i,N+1-j) = -eval(['Q' num2str(i-1) '_' num2str(j-1)]);
    end
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%% Difference operator %%
D1 = H\Q;
%%%%%%%%%%%%%%%%%%%%%%%%%%%