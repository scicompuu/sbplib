function [D1,H] = d1_noneq_minimal_6(N,h)

% N: Number of grid points
if(N<10)
    error('Operator requires at least 10 grid points');
end

% BP: Number of boundary points
BP = 5;

%%%% Norm matrix %%%%%%%%
P = sparse(BP,1);
%#ok<*NASGU>
P0 =  1.2740260779883e-01;
P1 =  6.1820981002054e-01;
P2 =  9.4308973897679e-01;
P3 =  1.0093019060199e+00;
P4 =  9.9884825610465e-01;

for i = 0:BP-1
    P(i+1) = eval(['P' num2str(i)]);
end

H = ones(N,1);
H(1:BP) = P;
H(end-BP+1:end) = flip(P);
H = spdiags(h*H,0,N,N);
%%%%%%%%%%%%%%%%%%%%%%%%%

%%%% Q matrix %%%%%%%%%%%
% interior stencil
order = 6;
d = [-1/60,3/20,-3/4,0,3/4,-3/20,1/60];
d = repmat(d,N,1);
Q = spdiags(d,-order/2:order/2,N,N);

% Boundaries
Q0_0 = -5.0000000000000e-01;
Q0_1 =  6.3217364546846e-01;
Q0_2 = -1.6411963429825e-01;
Q0_3 =  3.6495407984639e-02;
Q0_4 = -4.5494191548490e-03;
Q0_5 =  0.0000000000000e+00;
Q0_6 =  0.0000000000000e+00;
Q0_7 =  0.0000000000000e+00;
Q1_0 = -6.3217364546846e-01;
Q1_1 =  0.0000000000000e+00;
Q1_2 =  8.0515625504417e-01;
Q1_3 = -2.0755653563249e-01;
Q1_4 =  3.4573926056780e-02;
Q1_5 =  0.0000000000000e+00;
Q1_6 =  0.0000000000000e+00;
Q1_7 =  0.0000000000000e+00;
Q2_0 =  1.6411963429825e-01;
Q2_1 = -8.0515625504417e-01;
Q2_2 =  0.0000000000000e+00;
Q2_3 =  7.9402676057785e-01;
Q2_4 = -1.6965680649860e-01;
Q2_5 =  1.6666666666667e-02;
Q2_6 =  0.0000000000000e+00;
Q2_7 =  0.0000000000000e+00;
Q3_0 = -3.6495407984639e-02;
Q3_1 =  2.0755653563249e-01;
Q3_2 = -7.9402676057785e-01;
Q3_3 =  0.0000000000000e+00;
Q3_4 =  7.5629896626333e-01;
Q3_5 = -1.5000000000000e-01;
Q3_6 =  1.6666666666667e-02;
Q3_7 =  0.0000000000000e+00;
Q4_0 =  4.5494191548490e-03;
Q4_1 = -3.4573926056780e-02;
Q4_2 =  1.6965680649860e-01;
Q4_3 = -7.5629896626333e-01;
Q4_4 =  0.0000000000000e+00;
Q4_5 =  7.5000000000000e-01;
Q4_6 = -1.5000000000000e-01;
Q4_7 =  1.6666666666667e-02;
for i = 1:BP
    for j = 1:BP
        Q(i,j) = eval(['Q' num2str(i-1) '_' num2str(j-1)]);
        Q(N+1-i,N+1-j) = -eval(['Q' num2str(i-1) '_' num2str(j-1)]);
    end
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%% Difference operator %%
D1 = H\Q;
%%%%%%%%%%%%%%%%%%%%%%%%%%%